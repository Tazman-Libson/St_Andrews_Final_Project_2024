"0","get_single_stock_info <- function(mod, n_num){"
"0","  means <- mod$MEANS[,n_num]"
"0","  vars <- mod$VARS[, n_num]"
"0","  return(list("
"0","    MEANS = means,"
"0","    VARS = vars))"
"0","}"
"0",""
"0","applerange <- seq(-14, 14, length.out = 10000)"
"0","apple_pdf_df <- data.frame("
"0","  ret_val = applerange"
"0",")"
"0","single_stock_pdf_given_state <- function(xval, m, n, mod){"
"0","  pars <- get_single_stock_info(mod, n)"
"0","  return("
"0","    dnorm(xval, mean = pars$MEANS[m], sd = pars$VARS[m])"
"0","  )"
"0","}"
"0","apple_pdf_df <- apple_pdf_df %>%"
"0","  mutate(state1 = single_stock_pdf_given_state(ret_val, m = 1, n = 1, mod= big_mod)) %>%"
"0","  mutate(state2 = single_stock_pdf_given_state(ret_val, m = 2, n = 1, mod= big_mod)) %>%"
"0","  mutate(state3 = single_stock_pdf_given_state(ret_val, m = 3, n = 1, mod= big_mod))"
"0",""
"0","ggplot(apple_pdf_df)+"
"0","  geom_line(aes(x = ret_val, y = state1,color = 'red'))+"
"0","  geom_line(aes(x = ret_val, y = state2, color = 'blue'))+"
"0","  geom_line(aes(x = ret_val, y = state3, color = 'green'))+"
"0","  labs("
"0","    title = 'Marinalized pdfs for Apple Returns',"
"0","    x = 'Return Value',"
"0","    y = 'dnorm(x)',"
"0","    aes()"
"0","  )+scale_color_discrete(name = 'State', "
"0","                       labels  = c(1, 3, 2))"
