"0","##Demonstrative Graphs:"
"0","#Showing Conditional Distribution"
"0","mvn.pdf_mat <- function(X, mod){"
"0","  m <- dim(mod$TPM)[1]"
"0","  n <- dim(mod$CORR)[2]"
"0","  output <- matrix(nrow = m, ncol = n)"
"0","  prob_fun <- function(i){"
"0","    prob_sub_fun <- function(m){"
"0","      vars <- mod$VARS[,i]"
"0","      means <- mod$MEANS[,i]"
"0","      return(dnorm(X[i], mean = means[m], sd = vars[m]))"
"0","    }"
"0","    probs <- sapply(1:m,  FUN =prob_sub_fun)"
"0","  }"
"0","  probs <- sapply(1:n,  FUN =prob_fun, simplify = ""matrix"")"
"0","  return(probs)"
"0","}"
"0",""
"0",""
"0","mvn.pdf_element <- function(x,mod, obsmat, index){"
"0","  lenx         <- dim(x)[1]"
"0","  lenobs <- dim(obsmat)[1]"
"0","  m         <- dim(mod$TPM)[1]"
"0","  n <- dim(mod$CORR)[2]"
"0","  dxc       <- matrix(NA,nrow=lenx,ncol=n)"
"0","  Px        <- array(NA,dim = c(m, n, lenx))"
"0","  for (j in 1:lenx){ Px[,,j] <- mvn.pdf_mat( x[j,], mod)}"
"0","  la        <- mvn.lforward(obsmat,mod)"
"0","  lb        <- mvn.lbackward(obsmat,mod)"
"0","  la        <- rbind(log(mod$ID),la)"
"0","  lafact    <- apply(la,1,max)"
"0","  lbfact    <- apply(lb,1,max)"
"0","  for (i in 1:lenx)"
"0","  {"
"0","    foo      <- (exp(la[index,]-lafact[index])%*%mod$TPM)*exp(lb[index,]-lbfact[index])"
"0","    foo      <- foo/sum(foo)"
"0","    for(j in 1:n){"
"0","      dxc[i,j]  <- sum(Px[,j,i]%*%t(foo))"
"0","    }"
"0","  }"
"0","  return(dxc)"
"0","}"
"0",""
"0",""
"0","cond_dist_mat <- function(obs_matrix){"
"0","  n <- dim(obs_matrix)[2]"
"0","  mat <- matrix(nrow = 10000, ncol = n)"
"0","  for(i in 1:n){"
"0","    mat[,i] <- seq(min(obs_matrix[,i]), max(obs_matrix[,i]), length.out = 10000)"
"0","  }"
"0","  return(mat)"
"0","}"
"0","graph_cdf_index <- function(index){"
"0","  important_index = index"
"0","  "
"0","  cond_mat <- cond_dist_mat(ret_matrix)"
"0","  pdf_mat <- mvn.pdf_element(cond_mat, big_mod, ret_matrix, important_index)"
"0","  "
"0","  combined_mat <- cbind(cond_mat, pdf_mat)"
"0","  pdf_df <- data.frame("
"0","    apval = combined_mat[,1],"
"0","    micval = combined_mat[,2],"
"0","    metval = combined_mat[,3],"
"0","    intval = combined_mat[,4],"
"0","    appdf = combined_mat[,5],"
"0","    micpdf = combined_mat[,6],"
"0","    metpdf = combined_mat[,7],"
"0","    intpdf = combined_mat[,8]"
"0","  )"
"0","  pd1 <- ggplot(pdf_df)+"
"0","    geom_area(aes(x= apval, y = appdf), fill = 'red')+"
"0","    geom_vline(xintercept = resid_df[[important_index,2]])+"
"0","    labs("
"0","      y = 'Pdf Evaluation',"
"0","      x = 'Apple Return Value'"
"0","    )"
"0","  pd2 <- ggplot(pdf_df)+"
"0","    geom_area(aes(x= micval, y = micpdf), fill = 'blue')+"
"0","    geom_vline(xintercept = resid_df[[important_index,3]])+"
"0","    labs("
"0","      y = 'Pdf Evaluation',"
"0","      x = 'Microsoft Return Value'"
"0","    )"
"0","  pd3 <- ggplot(pdf_df)+"
"0","    geom_area(aes(x= metval, y = metpdf), fill = 'green')+"
"0","    geom_vline(xintercept = resid_df[[important_index,5]])+"
"0","    labs("
"0","      y = 'Pdf Evaluation',"
"0","      x = 'Meta Return Value'"
"0","    )"
"0","  pd4 <- ggplot(pdf_df)+"
"0","    geom_area(aes(x= metval, y = intpdf), fill = 'yellow')+"
"0","    geom_vline(xintercept = resid_df[[important_index,4]])+"
"0","    labs("
"0","      y = 'Pdf Evaluation',"
"0","      x = 'Intel Return Value'"
"0","    )"
"0","  "
"0","  "
"0","  multiplot(pd1, pd2, pd3, pd4, cols = 2)"
"0","}"
